# 1๏ธโฃ Execution Policy เคธเฅเค เคเคฐเฅเค
Set-ExecutionPolicy Unrestricted -Scope Process -Force

# 2๏ธโฃ Windows เคเคชเคกเฅเค เคเคฐเฅเค
Write-Host "๐ Windows เคเคชเคกเฅเค เคเฅเค เคเคฐ เคฐเคนเฅ เคนเฅเค..."
Start-Process "ms-settings:windowsupdate" -Wait

# 3๏ธโฃ Git & Chocolatey เคเคเคธเฅเคเฅเคฒ เคเคฐเฅเค (เคเคเคฐ เคชเคนเคฒเฅ เคธเฅ เคจเคนเฅเค เคนเฅ)
if (-Not (Get-Command git -ErrorAction SilentlyContinue)) {
    Write-Host "๐ Git เคเคเคธเฅเคเฅเคฒ เคเคฟเคฏเคพ เคเคพ เคฐเคนเคพ เคนเฅ..."
    Invoke-WebRequest -Uri "https://git-scm.com/download/win" -OutFile "$env:TEMP\git.exe"
    Start-Process "$env:TEMP\git.exe" -ArgumentList "/silent" -Wait
}

if (-Not (Get-Command choco -ErrorAction SilentlyContinue)) {
    Write-Host "๐ Chocolatey เคเคเคธเฅเคเฅเคฒ เคเคฐ เคฐเคนเฅ เคนเฅเค..."
    Set-ExecutionPolicy Bypass -Scope Process -Force
    Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
}

# 4๏ธโฃ Flutter เคเคฐ Android SDK เคเคเคธเฅเคเฅเคฒ เคเคฐเฅเค
if (-Not (Get-Command flutter -ErrorAction SilentlyContinue)) {
    Write-Host "๐ Flutter เคเคฐ Android SDK เคเคเคธเฅเคเฅเคฒ เคเคฐ เคฐเคนเฅ เคนเฅเค..."
    choco install flutter android-sdk -y
    refreshenv
}

# 5๏ธโฃ Python เคเคฐ เคเคตเคถเฅเคฏเค เคชเฅเคเฅเค เคเคเคธเฅเคเฅเคฒ เคเคฐเฅเค
if (-Not (Get-Command python -ErrorAction SilentlyContinue)) {
    Write-Host "๐ Python เคเคเคธเฅเคเฅเคฒ เคเคฐ เคฐเคนเฅ เคนเฅเค..."
    choco install python -y
    refreshenv
}

Write-Host "๐ Python dependencies เคเคเคธเฅเคเฅเคฒ เคเคฐ เคฐเคนเฅ เคนเฅเค..."
pip install flask openai pyttsx3 speechrecognition

# 6๏ธโฃ เคชเฅเคฐเฅเคเฅเคเฅเค เคกเคพเคเคจเคฒเฅเคก เคเคฐเฅเค เคเคฐ เคธเฅเคเคเคช เคเคฐเฅเค
Write-Host "๐ฅ AI Assistant เคเคพ เคเฅเคก เคกเคพเคเคจเคฒเฅเคก เคเคฐ เคฐเคนเฅ เคนเฅเค..."
git clone https://github.com/yourusername/yourrepo.git "$env:TEMP\AI_Assistant"
cd "$env:TEMP\AI_Assistant"

Write-Host "๐ Backend เคธเคฐเฅเคตเคฐ เคธเฅเคเคพเคฐเฅเค เคเคฐ เคฐเคนเฅ เคนเฅเค..."
Start-Process -NoNewWindow -FilePath "python" -ArgumentList "backend/app.py"

Write-Host "โ๏ธ Flutter เคเคช เคธเฅเคเคเคช เคเคฐ เคฐเคนเฅ เคนเฅเค..."
cd frontend
flutter pub get
flutter build apk

Write-Host "๐ฒ APK เคเคเคธเฅเคเฅเคฒ เคเคฐ เคฐเคนเฅ เคนเฅเค..."
adb install build/app/outputs/flutter-apk/app-release.apk

Write-Host "โ ๐ เคธเคฌ เคเฅเค เคเคเคธเฅเคเฅเคฒ เคนเฅ เคเคฏเคพ! เคเคฌ เคเคช เคเคชเคจเฅ เคฎเฅเคฌเคพเคเคฒ เคชเคฐ เคเคช เคเคฒเคพ เคธเคเคคเฅ เคนเฅเค!"
